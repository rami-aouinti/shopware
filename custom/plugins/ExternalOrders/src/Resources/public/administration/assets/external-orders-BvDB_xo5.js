const{ApiService:a}=Shopware.Classes;class l extends a{constructor(t,r,d="external-orders"){super(t,r,d),this.name="externalOrderService"}async list({channel:t=null,search:r=null}={}){const d={};t&&(d.channel=t),r&&(d.search=r);const s=await this.httpClient.get(`_action/${this.getApiBasePath()}/list`,{headers:this.getBasicHeaders(),params:d});return a.handleResponse(s)}async detail(t){const r=await this.httpClient.get(`_action/${this.getApiBasePath()}/detail/${t}`,{headers:this.getBasicHeaders()});return a.handleResponse(r)}}Shopware.Application.addServiceProvider("externalOrderService",e=>{const t=Shopware.Application.getContainer("init"),r=(t==null?void 0:t.httpClient)??e.httpClient,d=e.loginService??Shopware.Service("loginService");return new l(r,d)});const n=`<div class="external-orders"> <header class="external-orders__header"> <h2>Bestellübersichten</h2> </header> <main id="main" class="sw-page__main-content" tabindex="-1"> <div class="external-orders__page"> <sw-card class="external-orders__channels"> <div class="external-orders__channel-tabs"> <button v-for="channel in channels" :key="channel.id" class="external-orders__channel-tab" :class="{ 'is--active': activeChannel === channel.id }" type="button" @click="activeChannel = channel.id; loadOrders()" > <span class="external-orders__channel-logo"> <img :src="channel.logo" :alt="channel.label" /> </span> <span class="external-orders__channel-label">{{ channel.label }}</span> </button> </div> <div class="external-orders__summary"> <div class="external-orders__summary-title"> <span>Bestellungen aus {{ activeChannelLabel }}</span> </div> <div v-if="activeChannelSource" class="external-orders__summary-source" > Quelle: {{ activeChannelSource }} </div> <div class="external-orders__summary-metrics"> <div class="external-orders__summary-item"> <span class="external-orders__summary-label">Bestellungen</span> <span class="external-orders__summary-value">{{ summary.orderCount }}</span> </div> <div class="external-orders__summary-item"> <span class="external-orders__summary-label">Gesamtumsatz</span> <span class="external-orders__summary-value">{{ formatCurrency(summary.totalRevenue) }}</span> </div> <div class="external-orders__summary-item"> <span class="external-orders__summary-label">Stück</span> <span class="external-orders__summary-value">{{ summary.totalItems }}</span> </div> </div> <div class="external-orders__summary-actions"> <sw-button variant="primary" size="small" @click="exportSelectedOrdersPdf" > <sw-icon name="regular-file-text" size="16" class="external-orders__download-icon" /> PDF herunterladen ({{ selectedOrders.length > 0 ? selectedOrders.length : filteredOrders.length }}) </sw-button> <sw-button variant="secondary" size="small" @click="exportSelectedOrdersExcel" > <sw-icon name="regular-file" size="16" class="external-orders__download-icon" /> Excel herunterladen ({{ selectedOrders.length > 0 ? selectedOrders.length : filteredOrders.length }}) </sw-button> </div> </div> </sw-card> <sw-card> <div class="external-orders__filters-bar"> <div class="external-orders__search-row"> <sw-search-bar v-model="tableSearchTerm" placeholder="Suche Bestellungen" :show-search-types="false" class="external-orders__search" @search="onSearch" /> </div> <div class="external-orders__filters-row"> <div class="external-orders__filters"> <sw-button variant="primary" size="small" @click="resetFilters"> <sw-icon name="regular-filter" size="16" /> Filter löschen </sw-button> <sw-datepicker placeholder="Start Datum" class="external-orders__date" size="small" date-type="date" /> <sw-datepicker placeholder="End Datum" class="external-orders__date" size="small" date-type="date" /> <sw-button variant="primary" size="small">Anwenden</sw-button> <sw-button variant="primary" size="small" :disabled="!hasSelectedOrders" @click="openTestMarkingModal" > Testmarkierung Anwenden </sw-button> </div> </div> </div> <sw-data-grid v-if="paginatedOrders.length > 0" :data-source="paginatedOrders" :columns="columns" :loading="isLoading" :sort-by="sortBy" :sort-direction="sortDirection" class="external-orders__table" identifier="external-orders" @column-sort="onSortColumn" @selection-change="onSelectionChange" > <template slot="column-orderNumber-label"> <div class="external-orders__column-header"> <span class="external-orders__column-label">BestellNr</span> <button class="external-orders__column-filter-button" :class="{ 'is--active': isColumnFilterActive('orderNumber') }" type="button" @click.stop="toggleColumnFilter('orderNumber')" > <sw-icon name="regular-filter" size="16" /> </button> <div v-if="activeColumnFilter === 'orderNumber'" class="external-orders__column-filter-panel" @click.stop > <sw-single-select v-model="columnFilterMatchMode" :options="columnFilterMatchOptions" size="small" class="external-orders__column-filter-field" /> <sw-single-select v-model="columnFilters.orderNumber.operator" :options="columnFilterOperatorOptions" size="small" class="external-orders__column-filter-field" /> <sw-text-field v-model="columnFilters.orderNumber.value" size="small" class="external-orders__column-filter-field" /> <sw-button variant="primary" size="small" class="external-orders__column-filter-add" disabled > + Add Rule </sw-button> <div class="external-orders__column-filter-actions"> <sw-button variant="secondary" size="small" @click="clearColumnFilter('orderNumber')" > Clear </sw-button> <sw-button variant="primary" size="small" @click="applyColumnFilter" > Apply </sw-button> </div> </div> </div> </template> <template slot="column-customerName-label"> <div class="external-orders__column-header"> <span class="external-orders__column-label">Kundenname</span> <button class="external-orders__column-filter-button" :class="{ 'is--active': isColumnFilterActive('customerName') }" type="button" @click.stop="toggleColumnFilter('customerName')" > <sw-icon name="regular-filter" size="16" /> </button> <div v-if="activeColumnFilter === 'customerName'" class="external-orders__column-filter-panel" @click.stop > <sw-single-select v-model="columnFilterMatchMode" :options="columnFilterMatchOptions" size="small" class="external-orders__column-filter-field" /> <sw-single-select v-model="columnFilters.customerName.operator" :options="columnFilterOperatorOptions" size="small" class="external-orders__column-filter-field" /> <sw-text-field v-model="columnFilters.customerName.value" size="small" class="external-orders__column-filter-field" /> <sw-button variant="primary" size="small" class="external-orders__column-filter-add" disabled > + Add Rule </sw-button> <div class="external-orders__column-filter-actions"> <sw-button variant="secondary" size="small" @click="clearColumnFilter('customerName')" > Clear </sw-button> <sw-button variant="primary" size="small" @click="applyColumnFilter" > Apply </sw-button> </div> </div> </div> </template> <template slot="column-orderReference-label"> <div class="external-orders__column-header"> <span class="external-orders__column-label">AuftragsNr</span> <button class="external-orders__column-filter-button" :class="{ 'is--active': isColumnFilterActive('orderReference') }" type="button" @click.stop="toggleColumnFilter('orderReference')" > <sw-icon name="regular-filter" size="16" /> </button> <div v-if="activeColumnFilter === 'orderReference'" class="external-orders__column-filter-panel" @click.stop > <sw-single-select v-model="columnFilterMatchMode" :options="columnFilterMatchOptions" size="small" class="external-orders__column-filter-field" /> <sw-single-select v-model="columnFilters.orderReference.operator" :options="columnFilterOperatorOptions" size="small" class="external-orders__column-filter-field" /> <sw-text-field v-model="columnFilters.orderReference.value" size="small" class="external-orders__column-filter-field" /> <sw-button variant="primary" size="small" class="external-orders__column-filter-add" disabled > + Add Rule </sw-button> <div class="external-orders__column-filter-actions"> <sw-button variant="secondary" size="small" @click="clearColumnFilter('orderReference')" > Clear </sw-button> <sw-button variant="primary" size="small" @click="applyColumnFilter" > Apply </sw-button> </div> </div> </div> </template> <template slot="column-email-label"> <div class="external-orders__column-header"> <span class="external-orders__column-label">Email</span> <button class="external-orders__column-filter-button" :class="{ 'is--active': isColumnFilterActive('email') }" type="button" @click.stop="toggleColumnFilter('email')" > <sw-icon name="regular-filter" size="16" /> </button> <div v-if="activeColumnFilter === 'email'" class="external-orders__column-filter-panel" @click.stop > <sw-single-select v-model="columnFilterMatchMode" :options="columnFilterMatchOptions" size="small" class="external-orders__column-filter-field" /> <sw-single-select v-model="columnFilters.email.operator" :options="columnFilterOperatorOptions" size="small" class="external-orders__column-filter-field" /> <sw-text-field v-model="columnFilters.email.value" size="small" class="external-orders__column-filter-field" /> <sw-button variant="primary" size="small" class="external-orders__column-filter-add" disabled > + Add Rule </sw-button> <div class="external-orders__column-filter-actions"> <sw-button variant="secondary" size="small" @click="clearColumnFilter('email')" > Clear </sw-button> <sw-button variant="primary" size="small" @click="applyColumnFilter" > Apply </sw-button> </div> </div> </div> </template> <template slot="column-date-label"> <div class="external-orders__column-header"> <span class="external-orders__column-label">Datum</span> <button class="external-orders__column-filter-button" :class="{ 'is--active': isColumnFilterActive('date') }" type="button" @click.stop="toggleColumnFilter('date')" > <sw-icon name="regular-filter" size="16" /> </button> <div v-if="activeColumnFilter === 'date'" class="external-orders__column-filter-panel" @click.stop > <sw-single-select v-model="columnFilterMatchMode" :options="columnFilterMatchOptions" size="small" class="external-orders__column-filter-field" /> <sw-single-select v-model="columnFilters.date.operator" :options="columnFilterOperatorOptions" size="small" class="external-orders__column-filter-field" /> <sw-text-field v-model="columnFilters.date.value" size="small" class="external-orders__column-filter-field" /> <sw-button variant="primary" size="small" class="external-orders__column-filter-add" disabled > + Add Rule </sw-button> <div class="external-orders__column-filter-actions"> <sw-button variant="secondary" size="small" @click="clearColumnFilter('date')" > Clear </sw-button> <sw-button variant="primary" size="small" @click="applyColumnFilter" > Apply </sw-button> </div> </div> </div> </template> <template slot="column-statusLabel-label"> <div class="external-orders__column-header"> <span class="external-orders__column-label">Bestellstatus</span> <button class="external-orders__column-filter-button" :class="{ 'is--active': isColumnFilterActive('statusLabel') }" type="button" @click.stop="toggleColumnFilter('statusLabel')" > <sw-icon name="regular-filter" size="16" /> </button> <div v-if="activeColumnFilter === 'statusLabel'" class="external-orders__column-filter-panel" @click.stop > <sw-single-select v-model="columnFilterMatchMode" :options="columnFilterMatchOptions" size="small" class="external-orders__column-filter-field" /> <sw-single-select v-model="columnFilters.statusLabel.operator" :options="columnFilterOperatorOptions" size="small" class="external-orders__column-filter-field" /> <sw-text-field v-model="columnFilters.statusLabel.value" size="small" class="external-orders__column-filter-field" /> <sw-button variant="primary" size="small" class="external-orders__column-filter-add" disabled > + Add Rule </sw-button> <div class="external-orders__column-filter-actions"> <sw-button variant="secondary" size="small" @click="clearColumnFilter('statusLabel')" > Clear </sw-button> <sw-button variant="primary" size="small" @click="applyColumnFilter" > Apply </sw-button> </div> </div> </div> </template> <template slot="column-statusLabel" slot-scope="{ item }"> <sw-label :variant="statusVariant(item.status)" size="small"> {{ item.statusLabel }} </sw-label> </template> <template slot="column-actions" slot-scope="{ item }"> <sw-button variant="ghost" size="small" class="external-orders__action" @click="openDetail(item)" > <sw-icon name="regular-eye" size="16" /> </sw-button> </template> </sw-data-grid> <div v-if="paginatedOrders.length > 0" class="external-orders__pagination" > <sw-pagination :page="page" :limit="limit" :total="paginationTotal" :total-visible="7" @page-change="onPageChange" /> </div> <sw-empty-state v-else icon="regular-shopping-cart" title="Keine Bestellungen gefunden" subline="Es wurden keine Bestellungen für die aktuelle Auswahl geladen." /> </sw-card> <sw-modal v-if="showDetailModal && selectedOrder" :title="`Bestellübersicht für ${selectedOrder.orderNumber}`" variant="large" class="external-orders__detail-modal" @modal-close="closeDetail" > <div class="external-orders__detail"> <sw-card title="Zusätzliche Bestellinformationen" class="external-orders__detail-card"> <div class="external-orders__detail-grid"> <div class="external-orders__detail-section"> <h4>Kundendetails</h4> <dl> <dt>Kundenname</dt> <dd>{{ selectedOrder.customer.firstName }} {{ selectedOrder.customer.lastName }}</dd> <dt>Kundennummer</dt> <dd>{{ selectedOrder.customer.number }}</dd> <dt>Vorname</dt> <dd>{{ selectedOrder.customer.firstName }}</dd> <dt>Nachname</dt> <dd>{{ selectedOrder.customer.lastName }}</dd> <dt>Kunden-Mail-Adresse</dt> <dd>{{ selectedOrder.customer.email }}</dd> <dt>Kundengruppe</dt> <dd>{{ selectedOrder.customer.group }}</dd> </dl> </div> <div class="external-orders__detail-section"> <h4>Zahlungsdetails</h4> <dl> <dt>Zahlungsmethode</dt> <dd>{{ selectedOrder.payment.method }}</dd> <dt>Zahlungscode</dt> <dd>{{ selectedOrder.payment.code }}</dd> <dt>Fälligkeitsdatum</dt> <dd>{{ selectedOrder.payment.dueDate }}</dd> <dt>Ausstehender Betrag</dt> <dd>{{ selectedOrder.payment.outstanding }}</dd> <dt>Abgerechnet</dt> <dd>{{ selectedOrder.payment.settled }}</dd> <dt>Zusatzinfo</dt> <dd>{{ selectedOrder.payment.extra }}</dd> </dl> </div> <div class="external-orders__detail-section"> <h4>Rechnungsanschrift</h4> <dl> <dt>Straße</dt> <dd>{{ selectedOrder.billingAddress.street }}</dd> <dt>PLZ</dt> <dd>{{ selectedOrder.billingAddress.zip }}</dd> <dt>Stadt</dt> <dd>{{ selectedOrder.billingAddress.city }}</dd> <dt>Land</dt> <dd>{{ selectedOrder.billingAddress.country }}</dd> </dl> </div> <div class="external-orders__detail-section"> <h4>Lieferanschrift</h4> <dl> <dt>Lieferadresse</dt> <dd>{{ selectedOrder.shippingAddress.name }}</dd> <dt>Lieferstraße</dt> <dd>{{ selectedOrder.shippingAddress.street }}</dd> <dt>Postleitzahl/Stadt</dt> <dd>{{ selectedOrder.shippingAddress.zipCity }}</dd> <dt>Land</dt> <dd>{{ selectedOrder.shippingAddress.country }}</dd> </dl> </div> <div class="external-orders__detail-section"> <h4>Weitere Details</h4> <dl> <dt>Bestelldatum</dt> <dd>{{ selectedOrder.additional.orderDate }}</dd> <dt>Status</dt> <dd>{{ selectedOrder.additional.status }}</dd> <dt>Bestelltyp</dt> <dd>{{ selectedOrder.additional.orderType }}</dd> <dt>Notizen</dt> <dd>{{ selectedOrder.additional.notes }}</dd> <dt>Fachberater</dt> <dd>{{ selectedOrder.additional.consultant }}</dd> <dt>Mandant</dt> <dd>{{ selectedOrder.additional.tenant }}</dd> <dt>San6 Auftragsnummer</dt> <dd>{{ selectedOrder.additional.san6OrderNumber }}</dd> </dl> </div> <div class="external-orders__detail-section"> <h4>Erweiterte Bestelldaten</h4> <dl> <dt>Versanddienstleister</dt> <dd>{{ selectedOrder.shipping.carrier }}</dd> <dt>Trackingnummer(n)</dt> <dd>{{ selectedOrder.shipping.trackingNumbers.join(', ') }}</dd> <dt>Einträge in Orgas San6</dt> <dd>{{ selectedOrder.additional.orgaEntries.join(', ') }}</dd> <dt>Dokumente aus Bildarchiv San6</dt> <dd>{{ selectedOrder.additional.documents.join(', ') }}</dd> <dt>PDMS ID + Variante</dt> <dd>{{ selectedOrder.additional.pdmsId }} / {{ selectedOrder.additional.pdmsVariant }}</dd> <dt>TopM Artikelnummer + Ausführung</dt> <dd>{{ selectedOrder.additional.topmArticleNumber }} / {{ selectedOrder.additional.topmExecution }}</dd> <dt>Bestellstatushistorie Gambio/Shopware</dt> <dd>{{ selectedOrder.additional.statusHistorySource }}</dd> </dl> </div> </div> </sw-card> <sw-card title="Bestellprodukte" class="external-orders__detail-card"> <sw-data-grid :data-source="selectedOrder.items" :columns="[ { property: 'name', label: 'Produktname' }, { property: 'quantity', label: 'Menge' }, { property: 'netPrice', label: 'Nettowert' }, { property: 'taxRate', label: 'Steuersatz' }, { property: 'grossPrice', label: 'Bruttowert' }, { property: 'totalPrice', label: 'Gesamtwert' }, ]" identifier="external-orders-items" > <template #column-netPrice="{ item }"> {{ formatCurrency(item.netPrice) }} </template> <template #column-taxRate="{ item }"> {{ item.taxRate }}% </template> <template #column-grossPrice="{ item }"> {{ formatCurrency(item.grossPrice) }} </template> <template #column-totalPrice="{ item }"> {{ formatCurrency(item.totalPrice) }} </template> </sw-data-grid> </sw-card> <sw-card title="Statusverlauf" class="external-orders__detail-card"> <sw-data-grid :data-source="selectedOrder.statusHistory" :columns="[ { property: 'status', label: 'Status' }, { property: 'date', label: 'Datum' }, { property: 'comment', label: 'Kommentare' }, ]" identifier="external-orders-history" /> </sw-card> <sw-card title="Bestellgesamtsummen" class="external-orders__detail-card"> <div class="external-orders__totals"> <div class="external-orders__totals-row"> <span>Warenwert</span> <span>{{ formatCurrency(selectedOrder.totals.items) }}</span> </div> <div class="external-orders__totals-row"> <span>Versandkosten</span> <span>{{ formatCurrency(selectedOrder.totals.shipping) }}</span> </div> <div class="external-orders__totals-row"> <span>Summe</span> <span>{{ formatCurrency(selectedOrder.totals.sum) }}</span> </div> <div class="external-orders__totals-row"> <span>inkl. MwSt.</span> <span>{{ formatCurrency(selectedOrder.totals.tax) }}</span> </div> <div class="external-orders__totals-row"> <span>Summe netto</span> <span>{{ formatCurrency(selectedOrder.totals.net) }}</span> </div> </div> </sw-card> </div> </sw-modal> <sw-modal v-if="showTestMarkingModal" title="Bestätigen von Änderungen der Testmarkierung" variant="medium" class="external-orders__testmarking-modal" @modal-close="closeTestMarkingModal" > <p class="external-orders__testmarking-intro"> Sie sind dabei, die folgenden Bestellungen als Testbestellungen zu markieren bzw. die Markierung aufzuheben. Bitte überprüfen Sie die Änderungen, bevor Sie sie bestätigen. </p> <div class="external-orders__testmarking-grid"> <div class="external-orders__testmarking-card"> <h4 class="external-orders__testmarking-title is--positive"> Als Test zu markierende Bestellungen </h4> <ul class="external-orders__testmarking-list"> <li v-for="order in testMarkingOrders" :key="getOrderKey(order)" > {{ getOrderDisplayLabel(order) }} </li> <li v-if="testMarkingOrders.length === 0"> Keine Bestellungen ausgewählt. </li> </ul> </div> <div class="external-orders__testmarking-card"> <h4 class="external-orders__testmarking-title is--negative"> Bestellungen, die nicht als Test markieren </h4> <ul class="external-orders__testmarking-list"> <li v-for="order in unmarkedTestOrders" :key="getOrderKey(order)" > {{ getOrderDisplayLabel(order) }} </li> <li v-if="unmarkedTestOrders.length === 0"> Keine Bestellungen ausgewählt. </li> </ul> </div> </div> <template #modal-footer> <sw-button variant="secondary" @click="closeTestMarkingModal"> Abbrechen </sw-button> <sw-button variant="primary" @click="applyTestMarking"> Bestätige </sw-button> </template> </sw-modal> </div> </main> </div>`,{Component:i,Mixin:o}=Shopware;i.register("external-orders-list",{template:n,inject:["externalOrderService"],mixins:[o.getByName("notification")],data(){return{isLoading:!1,orders:[],summary:{orderCount:0,totalRevenue:0,totalItems:0},channels:[{id:"b2b",label:"B2B-Shop"},{id:"ebay_de",label:"Ebay.de"},{id:"ebay_at",label:"Ebay.at"},{id:"kaufland",label:"Kaufland"},{id:"zonami",label:"Zonami"},{id:"peg",label:"PEG"}],activeChannel:"ebay_de",searchTerm:"",selectedOrder:null,showDetailModal:!1}},computed:{columns(){return[{property:"orderNumber",label:"BestellNr",sortable:!0,primary:!0},{property:"customerName",label:"Kundenname",sortable:!0},{property:"orderReference",label:"AuftragsNr",sortable:!0},{property:"email",label:"Email",sortable:!0},{property:"date",label:"Datum",sortable:!0},{property:"statusLabel",label:"Bestellstatus",sortable:!0},{property:"actions",label:"Ansicht",sortable:!1,width:"90px"}]}},created(){this.loadOrders()},methods:{async loadOrders(){this.isLoading=!0;try{const{orders:e,summary:t}=this.buildFakeOrders();this.orders=e,this.summary=t}catch(e){this.createNotificationError({title:"Bestellungen konnten nicht geladen werden",message:(e==null?void 0:e.message)||"Bitte prüfen Sie die Verbindung zu den externen APIs."})}finally{this.isLoading=!1}},async openDetail(e){this.isLoading=!0;try{this.selectedOrder=await this.externalOrderService.detail(e.id),this.showDetailModal=!0}catch(t){this.createNotificationError({title:"Bestelldetails konnten nicht geladen werden",message:(t==null?void 0:t.message)||"Bitte prüfen Sie die Verbindung zu den externen APIs."})}finally{this.isLoading=!1}},closeDetail(){this.showDetailModal=!1,this.selectedOrder=null},formatCurrency(e){return new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e)},statusVariant(e){return e==="processing"?"info":e==="shipped"?"success":e==="closed"?"danger":"neutral"},buildFakeOrders(){const e=[{id:"fake-1001",orderNumber:"EO-1001",customerName:"Anna Müller",orderReference:"A-3901",email:"anna.mueller@example.com",date:"2024-06-18",statusLabel:"In Bearbeitung",status:"processing"},{id:"fake-1002",orderNumber:"EO-1002",customerName:"Louis Schmidt",orderReference:"A-3902",email:"louis.schmidt@example.com",date:"2024-06-17",statusLabel:"Versendet",status:"shipped"},{id:"fake-1003",orderNumber:"EO-1003",customerName:"Sofia Weber",orderReference:"A-3903",email:"sofia.weber@example.com",date:"2024-06-16",statusLabel:"Abgeschlossen",status:"closed"}];return{orders:e,summary:{orderCount:e.length,totalRevenue:1290.45,totalItems:8}}}}});const{Module:c}=Shopware;c.register("external-orders",{type:"plugin",name:"external-orders",title:"Bestellübersichten",description:"Zentrale Übersicht für externe Bestellungen",color:"#009ee3",icon:"regular-shopping-cart",routes:{index:{component:"external-orders-list",path:"index",meta:{privilege:"admin"}}},navigation:[{id:"external-orders",label:"Bestellübersichten",color:"#009ee3",path:"external.orders.index",icon:"regular-shopping-cart",parent:"sw-order",position:45}]});
//# sourceMappingURL=external-orders-BvDB_xo5.js.map
